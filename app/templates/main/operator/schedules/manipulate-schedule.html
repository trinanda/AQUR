{% extends "main/base-template.html" %}
{% import 'macros/form_macros.html' as f %}

{% block scripts %}
{% endblock %}

{% block content %}

<style>
  button {
    width: 75px;
    height: 35px;
    margin-top: -20px;
  }
</style>

<div id="mainContent">
  <div class="row gap-20 masonry pos-r">
    <div class="masonry-sizer col-md-6"></div>
    <div class="masonry-item col-md-6">
      <div class="bgc-white p-20 bd">
        {% if schedule %}
        <h2 class="c-grey-900">Edit {{ schedule.student.full_name }} Schedule</h2>
        {% else %}
        <h2 class="c-grey-900">Add new Schedule</h2>
        {% endif %}

        {% set flashes = {
        'error': get_flashed_messages(category_filter=['form-error']),
        'warning': get_flashed_messages(category_filter=['form-check-email']),
        'info': get_flashed_messages(category_filter=['form-info']),
        'success': get_flashed_messages(category_filter=['form-success'])
        } %}
        <div class="mT-30">
          {{ f.begin_form(form, flashes) }}
          <div class="form-row">

	          {% if schedule %}
	            {{ f.begin_form(form, flashes) }}
								{{ f.render_form_field(form.schedule_day, extra_classes='form-group col-md-12') }}
								{{ f.render_form_field(form.start_at, extra_classes='form-group col-md-6', value=schedule.start_at) }}
								{{ f.render_form_field(form.end_at, extra_classes='form-group col-md-6', value=schedule.end_at) }}
								{{ f.render_form_field(form.course_status, extra_classes='form-group col-md-12') }}
			          <input class="btn btn-primary d-flex justify-content-center d-md-table mx-auto" type="submit" value="Update">
	            {{ f.end_form() }}
	          {% endif %}

          {% if step == "input_student_email" %}
				    <form action="{{ url_for('operator.add_schedule') }}" method="get">
							{{ f.render_form_field(form.student_email, extra_classes='form-group col-md-12') }}
					    <input type=hidden name="step" value="available_course">
					    <input class="btn btn-primary d-flex justify-content-center d-md-table mx-auto" type="submit" value="Check available course">
				    </form>
	        {% elif step == "available_course" %}
	          <form action="{{ url_for('operator.add_schedule') }}" method="get">
							{{ f.render_form_field(form.course_name, extra_classes='form-group col-md-12') }}
					    <input type=hidden name="step" value="type_of_class">
					    <input class="btn btn-primary d-flex justify-content-center d-md-table mx-auto" type="submit" value="Input Schedule">
	          </form>
	        {% elif step == "type_of_class" %}
	          <form action="{{ url_for('operator.add_schedule') }}" method="get">
							{{ f.render_form_field(form.type_of_class, extra_classes='form-group col-md-12') }}
					    <input type=hidden name="step" value="input_schedule">
					    <input class="btn btn-primary d-flex justify-content-center d-md-table mx-auto" type="submit" value="Input Schedule">
	          </form>
	        {% elif step == "input_schedule" %}
	          <form action="{{ url_for('operator.add_schedule') }}" method="get">
							{{ f.render_form_field(form.schedule_day, extra_classes='form-group col-md-12') }}
							{{ f.render_form_field(form.start_at, extra_classes='form-group col-md-12') }}
							{{ f.render_form_field(form.end_at, extra_classes='form-group col-md-12') }}
					    <input type=hidden name="step" value="input_teacher_email">
					    <input class="btn btn-primary d-flex justify-content-center d-md-table mx-auto" type="submit" value="Check Teacher">
	          </form>
	        {% elif step == "input_teacher_email" %}
	          <form action="{{ url_for('operator.add_schedule') }}" method="get">
						{{ f.render_form_field(form.teacher_email, extra_classes='form-group col-md-12') }}
					  <input type=hidden name="step" value="check_data">
				    <input class="btn btn-primary d-flex justify-content-center d-md-table mx-auto" type="submit" value="Check all input">
	          </form>
	        {% elif step == "check_data" %}
            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap table table-striped table-hover" cellspacing="0" width="100%">
              <tr>
                <th>Student email</th>
                <td>{{ student_email }}</td>
              </tr>
              <tr>
                <th>Course name</th>
                <td>{{ course_name }}</td>
              </tr>
              <tr>
                <th>Type of class</th>
                <td>{{ type_of_class }}</td>
              </tr>
	            <tr>
                <th>Day</th>
                <td>{{ schedule_day }}</td>
              <tr>
                <th>Start at</th>
                <td>{{ start_at }}</td>
              </tr>
              <tr>
                <th>End at</th>
                <td>{{ end_at }}</td>
              <tr>
                <th>Teacher email</th>
                <td>{{ teacher_email }}</td>
              </tr>
            </table>
            <form action="#" method="post">
  					  <input type=hidden name="step" value="submit">
              <input class="btn btn-primary d-flex justify-content-center d-md-table mx-auto" type="submit" value="Submit">
            </form>
	        {% elif step == "submit" %}
          {% endif %}
          {{ f.end_form() }}
        </div>
      </div>
      {# Implement CSRF protection for site #}
      {% if csrf_token()|safe %}
      <div style="visibility: text; display: none">
        <input type="text" name="csrf_token" value="{{ csrf_token()|safe }}">
      </div>
      {% endif %}
    </div>
  </div>

<!---->
<!---->
    {% if test %}
    <div class="masonry-sizer col-md-6"></div>
    <div class="masonry-item col-md-6">
      <div class="bgc-white p-20 bd">
        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap table table-striped table-hover" cellspacing="0" width="100%">
          <tr>
            <th>Teacher name</th>
            <th>Teacher email</th>
          </tr>
          <tr>
            <td>Ustadz Putro</td>
            <td>putro@gmail.com</td>
          </tr>
        </table>
      </div>
  </div>
    {% endif %}
<!---->
<!---->

  </div>
</div>

{% endblock %}
