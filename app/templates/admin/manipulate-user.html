{% extends "layouts/base-template.html" %}
{% import 'macros/form_macros.html' as f %}
{% import 'macros/check_password.html' as check %}

{% block scripts %}
{% endblock %}

{% block content %}

<style>
  button {
    width: 75px;
    height: 35px;
    margin-top: -20px;
  }
  /*this is just to organize the demo checkboxes*/
		label {
			margin-right: 20px;
		}
		input[type=checkbox].css-checkbox {
			position: absolute;
			z-index: -1000;
			left: -1000px;
			overflow: hidden;
			clip: rect(0 0 0 0);
			height: 1px;
			width: 1px;
			margin: -1px;
			padding: 0;
			border: 0;
		}
		input[type=checkbox].css-checkbox+label.css-label {
			padding-left: 55px;
			height: 50px;
			display: inline-block;
			line-height: 50px;
			background-repeat: no-repeat;
			background-position: 0 0;
			font-size: 24px;
			font-weight: normal;
			vertical-align: middle;
			cursor: pointer;
		}
		input[type=checkbox].css-checkbox:checked+label.css-label {
			background-position: 0 -50px;
		}
		label.css-label {
			background-image: url(http://csscheckbox.com/checkboxes/u/csscheckbox_7a51de2f6764739a60a1c57b7736eb7f.png);
			-webkit-touch-callout: none;
			-webkit-user-select: none;
			-khtml-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
		}
</style>

<div id="mainContent">
  <div class="row gap-20 masonry pos-r">
    <div class="masonry-sizer col-md-6"></div>
    <div class="masonry-item col-md-6">
      <div class="bgc-white p-20 bd">
        {% if form.password %}
        <h2 class="c-grey-900">Add new User</h2>
        {% elif user %}
        <h2 class="c-grey-900">Edit User</h2>
        {% else %}
        <h2 class="c-grey-900">Invite new User</h2>
        {% endif %}
        {% set flashes = {
        'error': get_flashed_messages(category_filter=['form-error']),
        'warning': get_flashed_messages(category_filter=['form-check-email']),
        'info': get_flashed_messages(category_filter=['form-info']),
        'success': get_flashed_messages(category_filter=['form-success'])
        } %}
        <div class="mT-30">
          {{ f.begin_form(form, flashes) }}
          <div class="form-row">
            {% if user %}
            {{ f.render_form_field(form.role, extra_classes='form-group col-md-12', value=user.role) }}
            {% else %}
            {{ f.render_form_field(form.role, extra_classes='form-group col-md-12') }}
            {% endif %}
            {% if user %}
            {{ f.render_form_field(form.first_name, extra_classes='form-group col-md-6', value=user.first_name) }}
            {% else %}
            {{ f.render_form_field(form.first_name, extra_classes='form-group col-md-6') }}
            {% endif %}
            {% if user %}
            {{ f.render_form_field(form.last_name, extra_classes='form-group col-md-6', value=user.last_name) }}
            {% else %}
            {{ f.render_form_field(form.last_name, extra_classes='form-group col-md-6') }}
            {% endif %}
            {% if user %}
            {{ f.render_form_field(form.email, extra_classes='form-group col-md-12', value=user.email) }}
            {% else %}
            {{ f.render_form_field(form.email, extra_classes='form-group col-md-12') }}
            {% endif %}
            {% if form.password %}
              {{ f.render_form_field(form.password, extra_classes='form-group col-md-6') }}
              {{ f.render_form_field(form.password2, extra_classes='form-group col-md-6') }}
            {% endif %}
            {% if user %}
              <div style="margin:0 auto; display: flex;justify-content: center;">
                <div style="color:#222;">
                  {% if user.confirmed == true %}
                    <input type="checkbox" name="confirmed" checked id="confirmed" class="css-checkbox" />
                  {% else %}
                    <input type="checkbox" name="confirmed" id="confirmed" class="css-checkbox" />
                  {% endif %}
                  <label for="confirmed" class="css-label">{{ _('Activate user') }}</label>
                </div>
              </div>
            {% endif %}
          </div>
          {{ f.form_message(flashes['error'], header='Something went wrong.', class='error') }}
          {{ f.form_message(flashes['warning'], header='Check your email.', class='warning') }}
          {{ f.form_message(flashes['info'], header='Information', class='info') }}
          {{ f.form_message(flashes['success'], header='Success!', class='success') }}
          <br>
          {#{{ f.render_form_field(form.submit) }}#}
          <button type="submit" class="btn btn-primary d-flex justify-content-center d-md-table mx-auto">
            Submit
          </button>
          {{ f.end_form() }}
          {% if form.password %}
            {{ check.password_check('password', 0) }}
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
